Earlier versions of portions of chapters 1 and 2 were previously published under the following titles. They appear here significantly revised and enlarged.